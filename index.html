<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏ä‡∏°</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
  // ==========================================
  // üî¥ URL ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°)
  const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyX2hTvwN2rzcLafiQfuWZTHZ5aRFJ8K3B4fPHn3NQkm67El3msX0qZdQC7a649tXiGQQ/exec"; 
  // ==========================================

  window.dataSdk = {
    init: async function(callback) {
      this.onDataChanged = callback.onDataChanged;
      await this.fetchData();
      return { isOk: true };
    },
    fetchData: async function() {
      try {
        const response = await fetch(GOOGLE_SCRIPT_URL + "?action=read");
        const data = await response.json();
        if (this.onDataChanged) this.onDataChanged(data);
      } catch (e) { console.error("Connection Error:", e); }
    },
    create: async function(newData) {
      try {
        await fetch(GOOGLE_SCRIPT_URL + "?action=create", { method: "POST", body: JSON.stringify(newData) });
        await this.fetchData(); return { isOk: true };
      } catch (e) { return { isOk: false }; }
    },
    delete: async function(item) {
      try {
        await fetch(GOOGLE_SCRIPT_URL + "?action=delete&id=" + item.__backendId, { method: "POST" });
        await this.fetchData(); return { isOk: true };
      } catch (e) { return { isOk: false }; }
    }
  };

  window.elementSdk = { init: function(options) { if(options.onConfigChange) options.onConfigChange({}); return { isOk: true }; } };
</script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    * { font-family: 'Inter', 'Prompt', sans-serif; }
    .modal-overlay { animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    .modal-content { animation: slideUp 0.3s ease; }
    
    .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
    .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
    
    .lang-btn { padding: 0.4rem 0.8rem; border-radius: 0.5rem; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.2s; border: 1px solid rgb(219, 234, 254); }
    .lang-btn.active { background-color: rgb(59, 130, 246); color: white; border-color: rgb(59, 130, 246); }
    .lang-btn.inactive { background-color: rgb(243, 244, 246); color: rgb(107, 114, 128); }
  </style>
 </head>
 <body class="h-full bg-gradient-to-br from-sky-50 via-blue-50 to-indigo-50">
  <div id="app" class="h-full w-full overflow-auto flex flex-col">
   <header class="bg-white/80 backdrop-blur-md border-b border-blue-100 sticky top-0 z-40 shadow-sm flex-shrink-0">
    <div class="max-w-7xl mx-auto px-4 py-3 md:py-4">
     <div class="flex flex-col md:flex-row md:items-center justify-between gap-3 md:gap-0">
      <div class="flex items-center gap-3">
       <div class="w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl flex items-center justify-center shadow-lg flex-shrink-0">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>
       </div>
       <div class="overflow-hidden">
        <h1 id="main-title" class="text-lg md:text-xl font-semibold text-slate-800 truncate">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏ä‡∏°</h1>
        <p class="text-xs text-slate-500" id="subtitle">Booking System</p>
       </div>
      </div>
      <div class="flex items-center justify-between md:justify-end gap-3">
       <div class="flex gap-1 bg-slate-100 p-1 rounded-lg"><button id="lang-th" class="lang-btn active text-xs md:text-sm">‡πÑ‡∏ó‡∏¢</button> <button id="lang-en" class="lang-btn inactive text-xs md:text-sm">English</button>
       </div><button id="admin-btn" class="px-3 py-2 md:px-4 bg-blue-50 hover:bg-blue-100 text-blue-600 rounded-lg text-sm font-medium transition-all flex items-center gap-2 border border-blue-200 whitespace-nowrap">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg><span id="admin-text">Admin</span> </button>
      </div>
     </div>
    </div>
   </header>

   <main class="flex-1 w-full max-w-7xl mx-auto px-3 md:px-4 py-4 md:py-6 pb-24">
    <div class="bg-white rounded-2xl p-4 md:p-5 mb-6 border border-blue-100 shadow-sm">
     <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
      <div class="flex items-center justify-between w-full sm:w-auto gap-3">
        <button id="prev-date" class="p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-all text-slate-600 border border-blue-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
        </button>
        <div class="text-center min-w-[140px]">
            <p id="current-date" class="text-xl md:text-2xl font-semibold text-slate-800"></p>
            <p id="current-day" class="text-sm text-blue-600 font-medium"></p>
        </div>
        <button id="next-date" class="p-2 bg-blue-50 hover:bg-blue-100 rounded-lg transition-all text-slate-600 border border-blue-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
        </button>
      </div>
      <button id="today-btn" class="w-full sm:w-auto px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-all shadow-md" data-th="‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ" data-en="Today"> ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ </button>
     </div>
    </div>
    
    <div class="bg-white rounded-2xl border border-blue-100 overflow-hidden shadow-sm mb-8">
     <div class="overflow-x-auto overscroll-x-contain custom-scrollbar">
      <table class="w-full text-sm">
       <thead>
        <tr class="bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-blue-100">
         <th class="px-4 py-4 text-left text-slate-700 font-semibold min-w-[100px] sticky left-0 bg-blue-50 z-10 border-r border-blue-100 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]" data-th="‡πÄ‡∏ß‡∏•‡∏≤" data-en="Time">‡πÄ‡∏ß‡∏•‡∏≤</th>
         <th class="px-4 py-4 text-center text-slate-700 font-semibold min-w-[280px] md:min-w-[350px]">
          <div class="flex items-center justify-center gap-2 flex-col md:flex-row"><span class="text-xl">üíé</span> <span id="room1-header" data-th="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet Meeting Room)" data-en="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet Meeting Room)">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet Meeting Room)</span></div></th>
         <th class="px-4 py-4 text-center text-slate-700 font-semibold min-w-[280px] md:min-w-[350px]">
          <div class="flex items-center justify-center gap-2 flex-col md:flex-row"><span class="text-xl">üèõÔ∏è</span> <span id="room2-header" data-th="‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree Auditorium)" data-en="‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree Auditorium)">‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree Auditorium)</span></div></th>
        </tr>
       </thead>
       <tbody id="schedule-table-body" class="divide-y divide-blue-100"></tbody>
      </table>
     </div>
    </div>

    <div class="mb-8">
        <div class="flex items-center gap-2 mb-4">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
            <h2 class="text-lg font-semibold text-slate-800" data-th="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ" data-en="Upcoming Bookings">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ</h2>
        </div>
        
        <div id="booking-summary-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            </div>
    </div>
    
    <div class="flex items-center justify-center gap-8 text-sm flex-wrap bg-white/50 p-3 rounded-xl border border-blue-50">
     <div class="flex items-center gap-2"><div class="w-5 h-5 bg-green-100 border border-green-300 rounded"></div><span class="text-slate-600" data-th="‡∏ß‡πà‡∏≤‡∏á" data-en="Available">‡∏ß‡πà‡∏≤‡∏á</span></div>
     <div class="flex items-center gap-2"><div class="w-5 h-5 bg-red-100 border border-red-300 rounded"></div><span class="text-slate-600" data-th="‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß" data-en="Booked">‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß</span></div>
    </div>

    <div class="mt-16 pt-8 border-t border-blue-200/60 flex flex-col items-center justify-center text-center pb-8">
        <div class="bg-gradient-to-br from-blue-100 to-indigo-100 p-3 rounded-2xl mb-3 shadow-inner">
            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
        </div>
        <p class="text-slate-500 text-xs md:text-sm font-medium mb-1" data-th="‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢" data-en="Developed by">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏î‡∏¢</p>
        <h3 class="font-bold text-sm md:text-base tracking-wide bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-indigo-600">
            ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏™‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
        </h3>
        <p class="text-slate-500 text-xs md:text-sm mt-1 font-medium">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏ä‡∏°</p>
    </div>
    </main>

   <button id="book-room-fab" class="md:hidden fixed bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-xl flex items-center justify-center z-30 hover:bg-blue-700 transition-transform active:scale-95">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
   </button>

   <div class="hidden md:flex justify-center fixed bottom-8 left-0 right-0 z-30 pointer-events-none">
     <button id="book-room-btn" class="pointer-events-auto px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all flex items-center gap-2 transform hover:-translate-y-1" data-th="‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°" data-en="Book a Meeting Room">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg><span>‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</span> 
     </button>
   </div>

   <div id="booking-modal" class="hidden fixed inset-0 z-50 overflow-y-auto">
    <div class="modal-overlay absolute inset-0 bg-black/30 backdrop-blur-sm fixed"></div>
    <div class="relative min-h-screen md:min-h-full flex items-end md:items-center justify-center p-0 md:p-4">
     <div class="modal-content bg-white rounded-t-2xl md:rounded-2xl w-full max-w-md border border-blue-100 shadow-2xl">
      <div class="p-5 border-b border-blue-100 sticky top-0 bg-white rounded-t-2xl z-10">
       <div class="flex items-center justify-between">
        <h3 id="booking-title" class="text-xl font-semibold text-slate-800" data-th="‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°" data-en="Book Meeting Room">‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</h3><button id="close-booking" class="p-2 hover:bg-blue-50 rounded-lg transition-all text-slate-400">
         <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
       </div>
      </div>
      <form id="booking-form" class="p-5 space-y-4 max-h-[75vh] overflow-y-auto">
       <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á *" data-en="Select Room *">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á *</label> 
       <select id="booking-room" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all appearance-none"> 
           <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á --</option> 
           <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£">üíé ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet Meeting Room)</option> 
           <option value="‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ">üèõÔ∏è ‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree Auditorium)</option> 
       </select>
       </div>
       <div>
           <label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà *" data-en="Date *">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà *</label> 
           <input type="date" id="booking-date-input" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all">
       </div>
       <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° *" data-en="Meeting Topic *">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° *</label> <input type="text" id="booking-topic" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-placeholder-th="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°" data-placeholder-en="Enter meeting topic" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">
       </div>
       <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á *" data-en="Organizer Name *">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á *</label> <input type="text" id="booking-name" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all" data-placeholder-th="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" data-placeholder-en="Enter your name" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
       </div>
       <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° *" data-en="Start Time *">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° *</label> 
            <div class="relative">
                <select id="booking-start" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all appearance-none"> </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></div>
            </div>
        </div>
        <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î *" data-en="End Time *">‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î *</label> 
            <div class="relative">
                <select id="booking-end" required class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all appearance-none"> </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-slate-500"><svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg></div>
            </div>
        </div>
       </div>
       <div id="booking-error" class="hidden text-red-600 text-sm bg-red-50 p-3 rounded-lg border border-red-200 flex items-start gap-2">
           <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
           <span class="break-words"></span>
       </div>
       <div class="pt-2">
        <button type="submit" id="submit-booking" class="w-full py-3.5 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white font-semibold rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg" data-th="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á" data-en="Confirm Booking"> <span>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</span> </button>
       </div>
      </form>
     </div>
    </div>
   </div>
   
   <div id="admin-modal" class="hidden fixed inset-0 z-50 overflow-y-auto">
    <div class="modal-overlay absolute inset-0 bg-black/30 backdrop-blur-sm fixed"></div>
    <div class="relative min-h-screen md:min-h-full flex items-center justify-center p-4">
     <div class="modal-content bg-white rounded-2xl w-full max-w-2xl border border-blue-100 shadow-xl max-h-[90vh] flex flex-col">
      <div class="p-5 border-b border-blue-100 flex-shrink-0">
       <div class="flex items-center justify-between">
        <h3 id="admin-title" class="text-xl font-semibold text-slate-800" data-th="üîê Admin Panel" data-en="üîê Admin Panel">üîê Admin Panel</h3><button id="close-admin" class="p-2 hover:bg-blue-50 rounded-lg transition-all text-slate-400">
         <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
       </div>
      </div><div id="admin-login" class="p-6">
       <div class="space-y-4">
        <div><label class="block text-sm font-medium text-slate-700 mb-2" data-th="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin" data-en="Admin Password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin</label> <input type="password" id="admin-password-input" class="w-full px-4 py-3 bg-blue-50 border border-blue-200 rounded-xl text-slate-800 placeholder-slate-400 focus:outline-none focus:border-blue-500 transition-all" data-placeholder-th="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" data-placeholder-en="Enter password" placeholder="‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
        </div>
        <div id="admin-login-error" class="hidden text-red-600 text-sm bg-red-50 p-3 rounded-lg border border-red-200"></div><button id="admin-login-btn" class="w-full py-3 bg-blue-500 hover:bg-blue-600 text-white font-semibold rounded-xl transition-all shadow-md" data-th="‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö" data-en="Login"> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö </button>
       </div>
      </div><div id="admin-content" class="hidden flex-1 overflow-hidden flex flex-col">
       <div class="p-4 border-b border-blue-100 flex-shrink-0 bg-slate-50">
        <div class="flex items-center justify-between flex-wrap gap-3">
         <p class="text-slate-600 font-medium" data-th="‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" data-en="Manage All Bookings">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
         <div class="flex gap-2 w-full sm:w-auto">
             <select id="admin-filter-room" class="w-full sm:w-auto px-3 py-2 bg-white border border-blue-200 rounded-lg text-slate-700 text-sm focus:outline-none shadow-sm"> 
                 <option value="all" data-th="‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á" data-en="All Rooms">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á</option> 
                 <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£">‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet)</option> 
                 <option value="‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ">‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree)</option> 
             </select>
         </div>
        </div>
       </div>
       <div id="admin-bookings" class="flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar"></div>
      </div>
     </div>
    </div>
   </div>
   
   <div id="toast" class="hidden fixed bottom-24 md:bottom-6 right-6 z-50 px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 max-w-[90vw] md:max-w-sm"><span id="toast-icon"></span> <span id="toast-message" class="font-medium text-sm md:text-base"></span></div>
   <div id="delete-confirm" class="hidden fixed inset-0 z-[60] px-4"><div class="absolute inset-0 bg-black/30 backdrop-blur-sm"></div><div class="relative h-full flex items-center justify-center p-0"><div class="bg-white rounded-2xl p-6 w-full max-w-sm border border-blue-100 shadow-xl text-center"><div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></div><h4 id="delete-title" class="text-xl font-semibold text-slate-800 mb-2" data-th="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?" data-en="Confirm Delete?">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?</h4><p id="delete-confirm-text" class="text-slate-600 text-sm mb-6"></p><div class="flex gap-3"><button id="cancel-delete" class="flex-1 py-3 bg-slate-100 hover:bg-slate-200 text-slate-700 font-medium rounded-xl transition-all" data-th="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" data-en="Cancel"> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å </button> <button id="confirm-delete" class="flex-1 py-3 bg-red-500 hover:bg-red-600 text-white font-medium rounded-xl transition-all" data-th="‡∏•‡∏ö" data-en="Delete"> ‡∏•‡∏ö </button></div></div></div></div>
  </div>

  <script>
    const defaultConfig = { main_title: 'Meeting Room Booking System', admin_password: 'admin1234' };
    let config = { ...defaultConfig };
    let bookings = [];
    let currentDate = new Date();
    let isAdminLoggedIn = false;
    let bookingToDelete = null;
    let currentLanguage = 'th';

    const rooms = [
      { id: 'room1', name: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£', nameEn: 'Diamond Conference Room', emoji: 'üíé' },
      { id: 'room2', name: '‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ', nameEn: 'Vichai Keeree Auditorium', emoji: 'üèõÔ∏è' }
    ];

    // üî• 1. ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 07:00 ‡∏ñ‡∏∂‡∏á 20:00
    const timeSlots = [];
    for (let h = 7; h <= 20; h++) {
      timeSlots.push(`${h.toString().padStart(2, '0')}:00`);
      if (h < 20) { // ‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤ 20:30
        timeSlots.push(`${h.toString().padStart(2, '0')}:30`);
      }
    }

    const translations = {
      th: { available: '‡∏ß‡πà‡∏≤‡∏á', booked: '‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß', conflict: '‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏∑‡πà‡∏ô', limitReached: '‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£', bookSuccess: '‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', deleteSuccess: '‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', error: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà', connectionError: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ', noBookings: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á', wrongPassword: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á' },
      en: { available: 'Available', booked: 'Booked', conflict: 'This time slot is already booked. Please select another time.', limitReached: 'System supports maximum 999 bookings.', bookSuccess: 'Meeting room booked successfully!', deleteSuccess: 'Booking deleted successfully', error: 'An error occurred. Please try again.', connectionError: 'Unable to connect to system.', noBookings: 'No bookings', wrongPassword: 'Incorrect password' }
    };

    const dataHandler = {
      onDataChanged(data) {
        bookings = data;
        renderScheduleTable();
        renderSummary(); 
        if (isAdminLoggedIn) { renderAdminBookings(); }
      }
    };

    async function init() {
      const result = await window.dataSdk.init(dataHandler);
      if (!result.isOk) { showToast(translations[currentLanguage].connectionError, 'error'); }
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => { config = { ...defaultConfig, ...newConfig }; applyConfig(); },
        mapToCapabilities: (cfg) => ({ recolorables: [], borderables: [] }),
        mapToEditPanelValues: (cfg) => new Map([ ['main_title', cfg.main_title || defaultConfig.main_title], ['admin_password', cfg.admin_password || defaultConfig.admin_password] ])
      });
      setupEventListeners();
      updateDateDisplay();
      populateTimeSelects();
      renderScheduleTable();
    }

    function applyConfig() { document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title; }

    function setupEventListeners() {
      document.getElementById('prev-date').addEventListener('click', () => changeDate(-1));
      document.getElementById('next-date').addEventListener('click', () => changeDate(1));
      document.getElementById('today-btn').addEventListener('click', goToToday);
      document.getElementById('book-room-btn').addEventListener('click', openBookingModal);
      document.getElementById('book-room-fab').addEventListener('click', openBookingModal);
      document.getElementById('admin-btn').addEventListener('click', openAdminModal);
      document.getElementById('close-admin').addEventListener('click', closeAdminModal);
      document.getElementById('booking-form').addEventListener('submit', handleBooking);
      document.getElementById('admin-login-btn').addEventListener('click', handleAdminLogin);
      document.getElementById('admin-filter-room').addEventListener('change', renderAdminBookings);
      document.getElementById('cancel-delete').addEventListener('click', closeDeleteConfirm);
      document.getElementById('confirm-delete').addEventListener('click', confirmDelete);
      document.getElementById('booking-start').addEventListener('change', updateEndTimeOptions);
      document.getElementById('booking-modal').querySelector('.modal-overlay').addEventListener('click', closeBookingModal);
      document.getElementById('admin-modal').querySelector('.modal-overlay').addEventListener('click', closeAdminModal);
      document.getElementById('lang-th').addEventListener('click', () => setLanguage('th'));
      document.getElementById('lang-en').addEventListener('click', () => setLanguage('en'));
    }

    function setLanguage(lang) {
      currentLanguage = lang;
      document.getElementById('lang-th').className = lang === 'th' ? 'lang-btn active text-xs md:text-sm' : 'lang-btn inactive text-xs md:text-sm';
      document.getElementById('lang-en').className = lang === 'en' ? 'lang-btn active text-xs md:text-sm' : 'lang-btn inactive text-xs md:text-sm';
      document.querySelectorAll('[data-th]').forEach(el => { if (el.dataset.en) { el.textContent = lang === 'th' ? el.dataset.th : el.dataset.en; } });
      document.querySelectorAll('[data-placeholder-th]').forEach(el => { if (el.dataset.placeholderEn) { el.placeholder = lang === 'th' ? el.dataset.placeholderTh : el.dataset.placeholderEn; } });
      const roomSelect = document.getElementById('booking-room');
      roomSelect.options[1].textContent = 'üíé ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet Meeting Room)';
      roomSelect.options[2].textContent = 'üèõÔ∏è ‡∏´‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree Auditorium)';
      const filterSelect = document.getElementById('admin-filter-room');
      filterSelect.options[0].textContent = lang === 'th' ? '‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á' : 'All Rooms';
      filterSelect.options[1].textContent = '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£ (Prakaiphet)';
      filterSelect.options[2].textContent = '‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ (Vichian Keeree)';
      renderScheduleTable();
      renderSummary(); 
      if (isAdminLoggedIn) { renderAdminBookings(); }
    }

    function changeDate(days) { currentDate.setDate(currentDate.getDate() + days); updateDateDisplay(); renderScheduleTable(); }
    function goToToday() { currentDate = new Date(); updateDateDisplay(); renderScheduleTable(); }
    function updateDateDisplay() {
      let options, thaiDate;
      if (currentLanguage === 'th') { options = { year: 'numeric', month: 'long', day: 'numeric' }; thaiDate = currentDate.toLocaleDateString('th-TH', options); } 
      else { options = { year: 'numeric', month: 'long', day: 'numeric' }; thaiDate = currentDate.toLocaleDateString('en-US', options); }
      document.getElementById('current-date').textContent = thaiDate;
      let dayNames;
      if (currentLanguage === 'th') { dayNames = ['‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏∏‡∏ò', '‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ', '‡∏®‡∏∏‡∏Å‡∏£‡πå', '‡πÄ‡∏™‡∏≤‡∏£‡πå']; document.getElementById('current-day').textContent = `‡∏ß‡∏±‡∏ô${dayNames[currentDate.getDay()]}`; } 
      else { dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']; document.getElementById('current-day').textContent = dayNames[currentDate.getDay()]; }
    }
    function getDateString(date) { return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`; }

    function renderSummary() {
        const container = document.getElementById('booking-summary-list');
        const today = new Date().setHours(0,0,0,0);
        let activeBookings = bookings.filter(b => {
            const bDate = new Date(b.date);
            return bDate >= today;
        });
        activeBookings.sort((a, b) => {
            const dateA = new Date(a.date + 'T' + a.start_time);
            const dateB = new Date(b.date + 'T' + b.start_time);
            return dateA - dateB;
        });
        if (activeBookings.length === 0) {
            container.innerHTML = `<div class="col-span-full text-center py-8 text-slate-400 bg-white rounded-xl border border-dashed border-slate-200">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ</div>`;
            return;
        }
        container.innerHTML = activeBookings.map(b => `
            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow flex flex-col gap-2">
                <div class="flex items-center gap-2 text-slate-500 text-xs">
                    <span class="bg-blue-50 text-blue-600 px-2 py-1 rounded-md font-medium">${b.room.includes('‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢') ? 'üíé ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£' : 'üèõÔ∏è ‡∏ß‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏£‡∏Ñ‡∏µ‡∏£‡∏µ'}</span>
                    <span>‚Ä¢</span>
                    <span>${formatThaiDate(b.date)}</span>
                </div>
                <h4 class="font-semibold text-slate-800 line-clamp-2">${b.topic}</h4>
                <div class="flex items-center justify-between text-sm mt-auto pt-2 border-t border-slate-50">
                    <span class="text-slate-600 flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>${b.start_time} - ${b.end_time}</span>
                    <span class="text-slate-500 font-medium">${b.booker_name}</span>
                </div>
            </div>
        `).join('');
    }

    function populateTimeSelects() {
      const startSelect = document.getElementById('booking-start');
      const endSelect = document.getElementById('booking-end');
      startSelect.innerHTML = '';
      endSelect.innerHTML = '';
      for (let i = 0; i < timeSlots.length - 1; i++) {
        const option = document.createElement('option');
        option.value = timeSlots[i];
        option.textContent = timeSlots[i] + ' ‡∏ô.';
        startSelect.appendChild(option);
      }
      updateEndTimeOptions();
    }

    function updateEndTimeOptions() {
      const startSelect = document.getElementById('booking-start');
      const endSelect = document.getElementById('booking-end');
      const startIndex = timeSlots.indexOf(startSelect.value);
      endSelect.innerHTML = '';
      for (let i = startIndex + 1; i < timeSlots.length; i++) {
        const option = document.createElement('option');
        option.value = timeSlots[i];
        option.textContent = timeSlots[i] + ' ‡∏ô.';
        endSelect.appendChild(option);
      }
    }

    // üî• 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏â‡∏•‡∏≤‡∏î‡∏Ç‡∏∂‡πâ‡∏ô (‡∏ã‡πà‡∏≠‡∏ô‡πÅ‡∏ñ‡∏ß‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡πÜ)
    function renderScheduleTable() {
      const dateStr = getDateString(currentDate);
      const tbody = document.getElementById('schedule-table-body');
      let html = '';
      
      // ‡∏ï‡∏±‡∏ß‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥‡∏ß‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏´‡∏ô‡πÇ‡∏î‡∏ô rowspan ‡∏ö‡∏±‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏µ‡πà‡πÅ‡∏ñ‡∏ß
      let skipCells = {};
      rooms.forEach(r => skipCells[r.name] = 0);

      for (let i = 0; i < timeSlots.length - 1; i++) {
        const startTime = timeSlots[i];
        
        html += '<tr class="border-b border-blue-100 hover:bg-blue-50/50 transition-colors">';
        
        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏ß‡∏•‡∏≤ (‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏Ñ‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏π‡πà ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡πâ‡∏á rowspan=2 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á) ---
        if (i % 2 === 0) {
          const hourEnd = timeSlots[i + 2] || timeSlots[timeSlots.length - 1]; 
          html += `<td rowspan="2" class="px-4 py-4 text-slate-700 font-medium sticky left-0 bg-white border-r border-blue-50 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.05)] text-xs md:text-sm whitespace-nowrap align-top">${startTime.substring(0,2)}:00 - ${hourEnd.substring(0,2)}:00</td>`;
        }

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ---
        rooms.forEach(room => {
          // ‡∏ñ‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤‡πÅ‡∏ñ‡∏ß‡∏ô‡∏µ‡πâ‡πÇ‡∏î‡∏ô‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡πâ‡∏ß‡∏¢ rowspan ‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ö‡∏ô ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏î td ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢
          if (skipCells[room.name] > 0) {
            skipCells[room.name]--;
            return; 
          }

          const roomBookings = bookings.filter(b => b.room === room.name && b.date === dateStr);
          const booking = roomBookings.find(b => {
            const bStart = timeSlots.indexOf(b.start_time);
            const bEnd = timeSlots.indexOf(b.end_time);
            return i >= bStart && i < bEnd;
          });

          if (booking) {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏Ñ‡∏ô‡∏à‡∏≠‡∏á (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì rowspan ‡πÑ‡∏î‡πâ‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)
            const bStart = timeSlots.indexOf(booking.start_time);
            const bEnd = timeSlots.indexOf(booking.end_time);
            const rowSpan = bEnd - bStart;
            skipCells[room.name] = rowSpan - 1; 
            
            html += `
              <td rowspan="${rowSpan}" class="px-2 py-2 md:px-4 md:py-4 schedule-cell bg-red-50 border border-red-200 rounded-lg relative align-top">
                <div class="space-y-1">
                  <p class="text-red-700 font-semibold text-xs md:text-sm line-clamp-2">üìå ${booking.topic}</p>
                  <p class="text-red-600 text-[10px] md:text-xs truncate">üë§ ${booking.booker_name}</p>
                  <p class="text-red-500 text-[10px] md:text-xs hidden md:block">${booking.start_time} - ${booking.end_time}</p>
                  <span class="inline-block mt-1 px-1.5 py-0.5 bg-red-500 text-white text-[10px] rounded font-medium">${translations[currentLanguage].booked}</span>
                </div>
              </td>
            `;
          } else {
            // ‡∏Å‡∏£‡∏ì‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á: ‡∏ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏´‡∏±‡∏ß‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏Å‡πá‡∏ß‡πà‡∏≤‡∏á ‡πÉ‡∏´‡πâ‡∏£‡∏ß‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡πÑ‡∏õ‡πÄ‡∏•‡∏¢
            let rowSpan = 1;
            if (i % 2 === 0) {
              const nextBooking = roomBookings.find(b => {
                const bStart = timeSlots.indexOf(b.start_time);
                const bEnd = timeSlots.indexOf(b.end_time);
                return (i + 1) >= bStart && (i + 1) < bEnd;
              });
              if (!nextBooking) {
                rowSpan = 2; // ‡∏£‡∏ß‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
                skipCells[room.name] = 1;
              }
            }
            
            html += `
              <td rowspan="${rowSpan}" class="px-2 py-2 md:px-4 md:py-4 schedule-cell available bg-green-50/50 border border-green-100/50 rounded-lg h-full">
                <div class="flex items-center justify-center h-full min-h-[40px]">
                  <span class="inline-block px-2 py-1 bg-green-100 text-green-700 text-[10px] md:text-xs rounded-full font-medium opacity-70">${translations[currentLanguage].available}</span>
                </div>
              </td>
            `;
          }
        });
        html += '</tr>';
      }
      tbody.innerHTML = html;
    }

    function openBookingModal() {
      document.getElementById('booking-room').value = '';
      document.getElementById('booking-date-input').value = getDateString(currentDate);
      document.getElementById('booking-error').classList.add('hidden');
      document.getElementById('booking-modal').classList.remove('hidden');
      populateTimeSelects();
    }

    function closeBookingModal() { document.getElementById('booking-modal').classList.add('hidden'); document.getElementById('booking-form').reset(); }

    async function handleBooking(e) {
      e.preventDefault();
      const room = document.getElementById('booking-room').value;
      const dateStr = document.getElementById('booking-date-input').value;
      const topic = document.getElementById('booking-topic').value.trim();
      const name = document.getElementById('booking-name').value.trim();
      const startTime = document.getElementById('booking-start').value;
      const endTime = document.getElementById('booking-end').value;
      
      if (!room || !dateStr) { document.getElementById('booking-error').classList.remove('hidden'); return; }
      
      const roomBookings = bookings.filter(b => b.room === room && b.date === dateStr);
      const startIdx = timeSlots.indexOf(startTime);
      const endIdx = timeSlots.indexOf(endTime);
      const hasConflict = roomBookings.some(b => {
        const bStart = timeSlots.indexOf(b.start_time);
        const bEnd = timeSlots.indexOf(b.end_time);
        return (startIdx < bEnd && endIdx > bStart);
      });
      
      if (hasConflict) { document.getElementById('booking-error').querySelector('span').textContent = translations[currentLanguage].conflict; document.getElementById('booking-error').classList.remove('hidden'); return; }
      if (bookings.length >= 999) { document.getElementById('booking-error').querySelector('span').textContent = translations[currentLanguage].limitReached; document.getElementById('booking-error').classList.remove('hidden'); return; }
      
      const submitBtn = document.getElementById('submit-booking');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<svg class="animate-spin w-5 h-5" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>' + (currentLanguage === 'th' ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏≠‡∏á...' : 'Booking...') + '</span>';
      
      const result = await window.dataSdk.create({ id: Date.now().toString(), room, topic, booker_name: name, date: dateStr, start_time: startTime, end_time: endTime, created_at: new Date().toISOString() });
      submitBtn.disabled = false;
      submitBtn.innerHTML = '<span>' + (currentLanguage === 'th' ? '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á' : 'Confirm Booking') + '</span>';
      if (result.isOk) { closeBookingModal(); showToast(translations[currentLanguage].bookSuccess, 'success'); } 
      else { document.getElementById('booking-error').querySelector('span').textContent = translations[currentLanguage].error; document.getElementById('booking-error').classList.remove('hidden'); }
    }

    function openAdminModal() { document.getElementById('admin-modal').classList.remove('hidden'); if (!isAdminLoggedIn) { document.getElementById('admin-login').classList.remove('hidden'); document.getElementById('admin-content').classList.add('hidden'); } }
    function closeAdminModal() { document.getElementById('admin-modal').classList.add('hidden'); document.getElementById('admin-password-input').value = ''; document.getElementById('admin-login-error').classList.add('hidden'); }
    function handleAdminLogin() {
      const password = document.getElementById('admin-password-input').value;
      if (password === config.admin_password || password === defaultConfig.admin_password) { isAdminLoggedIn = true; document.getElementById('admin-login').classList.add('hidden'); document.getElementById('admin-content').classList.remove('hidden'); renderAdminBookings(); } 
      else { document.getElementById('admin-login-error').textContent = translations[currentLanguage].wrongPassword; document.getElementById('admin-login-error').classList.remove('hidden'); }
    }

    function renderAdminBookings() {
      const container = document.getElementById('admin-bookings');
      const filterRoom = document.getElementById('admin-filter-room').value;
      let filtered = [...bookings];
      if (filterRoom !== 'all') { filtered = filtered.filter(b => b.room === filterRoom); }
      filtered.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
      
      if (filtered.length === 0) { container.innerHTML = '<p class="text-center text-slate-500 py-8">' + translations[currentLanguage].noBookings + '</p>'; return; }
      
      container.innerHTML = filtered.map(booking => `
        <div class="bg-white border border-blue-100 rounded-xl p-4 shadow-sm" data-booking-id="${booking.__backendId}">
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-2"><span class="text-lg">${booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£' ? 'üíé' : 'üèõÔ∏è'}</span><span class="text-slate-800 font-medium truncate text-sm md:text-base">${currentLanguage === 'th' ? booking.room : (booking.room === '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÄ‡∏û‡∏ä‡∏£' ? 'Prakaiphet Meeting Room' : 'Vichian Keeree Auditorium')}</span></div>
              <p class="text-blue-600 font-semibold mb-1">üìå ${booking.topic}</p>
              <div class="flex flex-col sm:flex-row sm:gap-4 text-sm text-slate-600"><span class="flex items-center gap-1">üë§ ${booking.booker_name}</span><span class="flex items-center gap-1">üìÖ ${formatThaiDate(booking.date)}</span><span class="flex items-center gap-1">üïê ${booking.start_time} - ${booking.end_time}</span></div>
            </div>
            <button onclick="showDeleteConfirm('${booking.__backendId}')" class="p-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg transition-all flex-shrink-0 border border-red-100"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg></button>
          </div>
        </div>
      `).join('');
    }

    function formatThaiDate(dateStr) {
      const [year, month, day] = dateStr.split('-');
      if (currentLanguage === 'th') { const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.']; return `${parseInt(day)} ${months[parseInt(month) - 1]} ${parseInt(year) + 543}`; } 
      else { const date = new Date(year, parseInt(month) - 1, parseInt(day)); return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }); }
    }

    function showDeleteConfirm(backendId) { const booking = bookings.find(b => b.__backendId === backendId); if (!booking) return; bookingToDelete = booking; document.getElementById('delete-confirm-text').textContent = `${currentLanguage === 'th' ? '‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á' : 'Delete booking'} "${booking.topic}" ${currentLanguage === 'th' ? '‡∏Ç‡∏≠‡∏á' : 'by'} ${booking.booker_name}?`; document.getElementById('delete-confirm').classList.remove('hidden'); }
    function closeDeleteConfirm() { document.getElementById('delete-confirm').classList.add('hidden'); bookingToDelete = null; }
    async function confirmDelete() { if (!bookingToDelete) return; const confirmBtn = document.getElementById('confirm-delete'); confirmBtn.disabled = true; confirmBtn.textContent = currentLanguage === 'th' ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...' : 'Deleting...'; const result = await window.dataSdk.delete(bookingToDelete); confirmBtn.disabled = false; confirmBtn.textContent = currentLanguage === 'th' ? '‡∏•‡∏ö' : 'Delete'; if (result.isOk) { closeDeleteConfirm(); showToast(translations[currentLanguage].deleteSuccess, 'success'); } else { showToast(translations[currentLanguage].error, 'error'); } }
    function showToast(message, type) { const toast = document.getElementById('toast'); const toastMessage = document.getElementById('toast-message'); const toastIcon = document.getElementById('toast-icon'); toastMessage.textContent = message; if (type === 'success') { toast.className = 'fixed bottom-24 md:bottom-6 right-6 z-50 px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 max-w-[90vw] md:max-w-sm bg-green-500 text-white'; toastIcon.textContent = '‚úì'; } else { toast.className = 'fixed bottom-24 md:bottom-6 right-6 z-50 px-6 py-4 rounded-xl shadow-lg flex items-center gap-3 max-w-[90vw] md:max-w-sm bg-red-500 text-white'; toastIcon.textContent = '‚úï'; } toast.classList.remove('hidden'); setTimeout(() => { toast.classList.add('hidden'); }, 3000); }
    init();
  </script>
 </body>
</html>